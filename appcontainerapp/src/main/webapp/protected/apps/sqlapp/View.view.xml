<mvc:XMLView height="100vh" class="sapUiSizeCompact"
	displayBlock="true" id="mainview" controllerName="ui5app.Controller"
	xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m" xmlns:l="sap.ui.layout"
	xmlns:t="sap.ui.table" xmlns:dnd="sap.ui.core.dnd"
	xmlns:ui5libs="ui5libs" xmlns:ui5app="ui5app"
	xmlns:core="sap.ui.core">
	<ui5libs:controls.AppContainerPage pageTitle="SQL">
		<VBox height="90%">
			<t:TreeTable id="sqltree"
				rows="{path:'/', parameters: {arrayNames:['children']}}"
				selectionMode="Single" selectionBehavior="RowOnly"
				enableSelectAll="false" visibleRowCountMode="Auto"
				>
				<t:layoutData>
					<FlexItemData growFactor="2"/>
				</t:layoutData>
				<t:extension>
					<Toolbar>
						<Title id="title" text="Execute Query" />
						<Label text="Limit"/>
						<Input id="limit" value="100" width="4rem" />
						<Label text="Drag over select-tree" />
						<Button text="join" >
							<dragDropConfig>
								<dnd:DragInfo
									groupName="tables"  />
							</dragDropConfig>
						</Button>
						<Button text="left outer join" >
							<dragDropConfig>
								<dnd:DragInfo
									groupName="tables"  />
							</dragDropConfig>
						</Button>
						<Button text="right outer join" >
							<dragDropConfig>
								<dnd:DragInfo
									groupName="tables"  />
							</dragDropConfig>
						</Button>
						<Button text="full outer join" >
							<dragDropConfig>
								<dnd:DragInfo
									groupName="tables"  />
							</dragDropConfig>
						</Button>
						<ToolbarSpacer />
						<Label text="History:" />
						<ComboBox
							items="{/history}">
							<core:Item text="{sql}" />
						</ComboBox>
						<Button text="save" >
						</Button>
					</Toolbar>
				</t:extension>
				<t:dragDropConfig>
					<dnd:DropInfo
						groupName="tables"
						targetAggregation="rows"
						dropPosition="On"
						drop="onDropTables"
						dragEnter="onDragEnterTables" />
				</t:dragDropConfig>
				<t:columns>
					<t:Column
						width="15%"
						autoResizable="true"
					>
						<Label text="Part" />
						<t:template>
							<Text text="{text}" wrapping="false" visible="{showText}" />
						</t:template>
					</t:Column>
					<t:Column
						autoResizable="true"
					>
						<Label text="SQL" />
						<t:template>
							<HBox width="100%">
								<ui5app:ContainsInput 
									value="{tablename}"
									enabled="{=${type} === 'table'}"
									visible="{=${type} === 'table'}"
									liveChange=".onInputChangeTable"
									change=".onChangeTable"
									showSuggestion="true"
									filterSuggests="false"
									suggest=".onHandleTableSuggest"
									suggestionItems="{ path: 'tables>/', templateShareable: true }"
								>
									<ui5app:layoutData>
										<FlexItemData growFactor="1"/>
									</ui5app:layoutData>
									<ui5app:suggestionItems>
										<core:Item text="{tables>qualifiershort}" />
									</ui5app:suggestionItems>
								</ui5app:ContainsInput>
								<ui5app:ContainsInput 
									value="{expression}"
									enabled="{=${type} === 'column' || ${type} === 'groupbycolumn'}"
									visible="{=${type} === 'column' || ${type} === 'groupbycolumn'}"
									liveChange=".onInputChange"
									showSuggestion="true"
									change=".onChangeExpression"
									filterSuggests="false"
									suggest=".onHandleColumnSuggest"
									suggestionItems="{ path: 'columns>/', templateShareable: true }"
								>
									<ui5app:layoutData>
										<FlexItemData growFactor="1"/>
									</ui5app:layoutData>
									<ui5app:suggestionItems>
										<core:Item text="{columns>qualifier}" />
									</ui5app:suggestionItems>
								</ui5app:ContainsInput>
								<ui5app:ContainsInput 
									value="{leftexpression}"
									enabled="{=${type} === 'condition'}"
									visible="{=${type} === 'condition'}"
									liveChange=".onInputChange"
									showSuggestion="true"
									filterSuggests="false"
									suggest=".onHandleColumnSuggest"
									suggestionItems="{ path: 'columns>/', templateShareable: true }"
								>
									<ui5app:layoutData>
										<FlexItemData growFactor="3"/>
									</ui5app:layoutData>
									<ui5app:suggestionItems>
										<core:Item text="{columns>qualifier}" />
									</ui5app:suggestionItems>
								</ui5app:ContainsInput>
								<ui5app:ContainsInput 
									value="{op}"
									enabled="{=${type} === 'condition'}"
									visible="{=${type} === 'condition'}"
									liveChange=".onInputChange"
									width="6rem"
								>
									<ui5app:layoutData>
										<FlexItemData growFactor="0"/>
									</ui5app:layoutData>
								</ui5app:ContainsInput>
								<ui5app:ContainsInput 
									value="{rightexpression}"
									enabled="{=${type} === 'condition'}"
									visible="{=${type} === 'condition'}"
									liveChange=".onInputChange"
									showSuggestion="true"
									filterSuggests="false"
									suggest=".onHandleColumnSuggest"
									suggestionItems="{ path: 'columns>/', templateShareable: true }"
								>
									<ui5app:layoutData>
										<FlexItemData growFactor="3"/>
									</ui5app:layoutData>
									<ui5app:suggestionItems>
										<core:Item text="{columns>qualifier}" />
									</ui5app:suggestionItems>
								</ui5app:ContainsInput>
							</HBox>
						</t:template>
					</t:Column>
					<t:Column
						width="10rem"
						autoResizable="true"
					>
						<Label text="Alias" />
						<t:template>
							<HBox alignItems="Center">
								<Label text="as" visible="{=${type} === 'table' || ${type} === 'column'}" wrapping="nowrap" />
								<Input 
									value="{alias}"
									enabled="{=${type} === 'table' || ${type} === 'column'}"
									visible="{=${type} === 'table' || ${type} === 'column'}"
									change=".onChangeAlias"
								>
								</Input>
							</HBox>
						</t:template>
					</t:Column>
					<t:Column
						width="4rem"
						autoResizable="true"
					>
						<Label text="Action" />
						<t:template>
							<HBox>
								<Button icon="sap-icon://delete" press=".onDeleteSQLPart" visible="{showDelete}" />
							</HBox>
						</t:template>
					</t:Column>
				</t:columns>
			</t:TreeTable>
			<t:Table
				id="idTableData"
				visibleRowCountMode="Auto"
				selectionMode="None" selectionBehavior="RowOnly"
				class="sapUiMediumMargin"
				>
				<t:layoutData>
					<FlexItemData growFactor="1"/>
				</t:layoutData>
                <t:extension>
                    <OverflowToolbar>
						<ToolbarSpacer />
                        <Button icon="sap-icon://physical-activity" tooltip="Execute" press=".onExecuteQuery"/>
                        <Button icon="sap-icon://resize" tooltip="Auto-resize all columns" press=".onTableDataResizeColumns"/>
                    </OverflowToolbar>
                </t:extension>
			</t:Table>
		</VBox>
	</ui5libs:controls.AppContainerPage>
</mvc:XMLView>
