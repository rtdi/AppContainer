<mvc:XMLView height="100vh"
	class="sapUiSizeCompact" 
	displayBlock="true"
	id="mainview"
	controllerName="ui5app.Controller"
	xmlns:mvc="sap.ui.core.mvc" 
	xmlns="sap.m"
	xmlns:l="sap.ui.layout"
	xmlns:t="sap.ui.table"
	xmlns:dnd="sap.ui.core.dnd"
	xmlns:ui5libs="ui5libs"
	xmlns:core="sap.ui.core">
	<ui5libs:controls.AppContainerPage pageTitle="Database">
		<l:ResponsiveSplitter defaultPane="default" height="100%">
			<l:layoutData>
				<FlexItemData growFactor="1"/>
			</l:layoutData>
			<l:PaneContainer>
				<l:SplitPane>
					<t:TreeTable id="idTree"
						rows="{path:'/', parameters: {arrayNames:['sources']}}"
						selectionMode="Single" selectionBehavior="RowOnly" enableSelectAll="false"
						ariaLabelledBy="title"
						toggleOpenState="onOpen"
						rowSelectionChange=".onSourceSelect"
						visibleRowCountMode="Auto">
					   	<t:customData>
					   		<ui5libs:controls.JsonContainer key="model" url="ui5rest/catalog/schemas" />
					   	</t:customData>
		                <t:extension>
		                    <OverflowToolbar>
								<ToolbarSpacer />
		                        <Button icon="sap-icon://refresh" tooltip="Refresh the database object tree" press="onRefresh"/>
		                    </OverflowToolbar>
		                </t:extension>
						<t:columns>
							<t:Column>
								<Label text="Object Tree"/>
								<t:template>
									<HBox>
										<core:Icon src="{path: 'objecttype', formatter: '.iconFormatter'}" class="sapUiSmallMarginEnd" />
										<Text text="{name}" wrapping="false" tooltip="{comment}" />
									</HBox> 
								</t:template>
							</t:Column>
						</t:columns>
					</t:TreeTable>
				</l:SplitPane>
				<l:SplitPane>
					<TabContainer class="sapUiResponsiveContentPadding sapUiResponsivePadding--header noCloseButtons" itemClose=".onItemClose" >
						<items >
							<TabContainerItem name="Columns" >
								<content>
									<t:Table
										id="idColumns"
										rows="{/}"
										visibleRowCountMode="Auto"
										enableCellFilter="true"
										>
						                <t:extension>
						                    <OverflowToolbar>
												<ToolbarSpacer />
						                        <Button icon="sap-icon://refresh" tooltip="Refresh the database object tree" press="onColumnRefresh"/>
						                    </OverflowToolbar>
						                </t:extension>
										<t:columns>
											<t:Column
												resizable="true"
												autoResizable="true"
												sortProperty="key"
												width="3em"
											>
												<Label text="Key"/>
												<t:template>
													<Text text="{pkindex}" wrapping="false" />
												</t:template>
											</t:Column>
											<t:Column
												filterProperty="name"
												resizable="true"
												autoResizable="true"
												sortProperty="name"
											>
												<Label text="Column Name"/>
												<t:template>
													<Text text="{name}" wrapping="false" tooltip="{comment}" />
												</t:template>
											</t:Column>
											<t:Column
												filterProperty="position"
												resizable="true"
												autoResizable="true"
												sortProperty="position"
												width="3em"
											>
												<Label text="Pos"/>
												<t:template>
													<Text text="{position}" wrapping="false" />
												</t:template>
											</t:Column>
											<t:Column
												filterProperty="datatype"
												resizable="true"
												autoResizable="true"
												sortProperty="datatype"
											>
												<Label text="Type"/>
												<t:template>
													<Text text="{datatype}" wrapping="false" />
												</t:template>
											</t:Column>
											<t:Column
												filterProperty="length"
												resizable="true"
												autoResizable="true"
												sortProperty="length"
												width="5em"
											>
												<Label text="Length"/>
												<t:template>
													<Text text="{length}" wrapping="false" />
												</t:template>
											</t:Column>
											<t:Column
												filterProperty="precision"
												resizable="true"
												autoResizable="true"
												sortProperty="precision"
												width="3em"
											>
												<Label text="Precision"/>
												<t:template>
													<Text text="{precision}" wrapping="false" />
												</t:template>
											</t:Column>
											<t:Column
												resizable="true"
												autoResizable="true"
												sortProperty="notnull"
												width="4em"
											>
												<Label text="Not Null"/>
												<t:template>
													<CheckBox selected="{notnull}" />
												</t:template>
											</t:Column>
										</t:columns>
									</t:Table>
								</content>
							</TabContainerItem>
							<TabContainerItem name="Data" >
								<content>
									<t:Table
										id="idTableData"
										visibleRowCountMode="Auto"
										rowsUpdated=".onTableDataResizeColumns"
										selectionMode="None" selectionBehavior="RowOnly"
										>
						                <t:extension>
						                    <OverflowToolbar>
												<ToolbarSpacer />
						                        <Button icon="sap-icon://resize" tooltip="Auto-resize all columns" press=".onTableDataResizeColumns"/>
												<Button icon="sap-icon://write-new-document" tooltip="Open in FreeForm SQL" press=".onFreeFormSQL"/>
						                        <Button icon="sap-icon://refresh" tooltip="Refresh the table contents" press=".onTableDataRefresh"/>
						                    </OverflowToolbar>
						                </t:extension>
									</t:Table>
								</content>
							</TabContainerItem>
							<TabContainerItem name="Dependencies" >
								<content>
								    <ui5libs:amcharts.Chart
								    	id="dependencychart"
								    	width="100%"
								    	height="100%"
								    	>
										<ui5libs:layoutData>
											<FlexItemData growFactor="1" />
										</ui5libs:layoutData>
										<ui5libs:children>
											<ui5libs:amcharts.base.Container
												width="100%"
												height="100%"
											>
												<ui5libs:children>
													<ui5libs:amcharts.base.ForceDirected
														downDepth="1"
													    initialDepth="5"
													    topDepth="0"
													    valueField="value"
													    categoryField="name"
													    childDataField="children"
													    componentData="{/}"
													>
													</ui5libs:amcharts.base.ForceDirected>
												</ui5libs:children>
											</ui5libs:amcharts.base.Container>
										</ui5libs:children>
								    </ui5libs:amcharts.Chart>
								</content>
							</TabContainerItem>
							<TabContainerItem name="Permissions" >
								<content>
								</content>
							</TabContainerItem>
						</items>
					</TabContainer>
				</l:SplitPane>
			</l:PaneContainer>
		</l:ResponsiveSplitter>
	</ui5libs:controls.AppContainerPage>
</mvc:XMLView>
